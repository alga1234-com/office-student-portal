<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Profile | OASIS Student Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    body {
      background: #f1f5f9;
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      color: #22223b;
    }
    .profile-container {
      max-width: 700px;
      margin: 2.5rem auto 2.5rem auto;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 16px #0001;
      padding: 2.2rem 1.5rem 2rem 1.5rem;
    }
    .profile-header {
      display: flex;
      align-items: center;
      gap: 1.2rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }
    .profile-avatar {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.3rem;
      color: #15803d;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .profile-info {
      flex: 1 1 120px;
    }
    .profile-info h2 {
      margin: 0 0 0.25em 0;
      font-size: 1.5rem;
      font-weight: 600;
      color: #15803d;
    }
    .profile-info p {
      margin: 0;
      color: #555;
      font-size: 1.02rem;
    }
    .role-switcher {
      margin-bottom: 1.5rem;
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }
    .role-switcher label {
      font-size: 1rem;
      color: #444;
    }
    .role-select {
      font-size: 1rem;
      padding: 0.37em 1.1em;
      border-radius: 7px;
      border: 1px solid #e5e7eb;
      background: #f8fafc;
      color: #222;
      min-width: 120px;
      font-weight: 500;
      transition: border 0.18s;
    }
    .role-select:focus {
      border: 1.5px solid #22c55e;
      outline: none;
    }
    .profile-section {
      margin-bottom: 2.1rem;
    }
    .profile-section-title {
      font-size: 1.13rem;
      font-weight: 650;
      color: #15803d;
      margin-bottom: 0.8rem;
    }
    .profile-form label {
      display: block;
      font-size: 1rem;
      color: #444;
      margin-bottom: 0.35em;
      margin-top: 1em;
    }
    .profile-form input, .profile-form textarea {
      width: 100%;
      font-size: 1rem;
      padding: 0.47em 0.7em;
      border: 1px solid #e5e7eb;
      border-radius: 7px;
      margin-bottom: 0.2em;
      background: #f8fafc;
      transition: border 0.18s;
    }
    .profile-form textarea {
      resize: vertical;
      min-height: 70px;
      max-height: 160px;
    }
    .profile-form input:focus, .profile-form textarea:focus {
      border: 1.5px solid #22c55e;
      outline: none;
    }
    .profile-form .profile-save-btn {
      background: #22c55e;
      color: #fff;
      border: none;
      border-radius: 999px;
      font-size: 1rem;
      font-weight: 600;
      padding: 0.44em 1.4em;
      margin-top: 1.2em;
      cursor: pointer;
      transition: background 0.18s;
      display: block;
    }
    .profile-form .profile-save-btn:hover {
      background: #15803d;
    }
    .profile-activities {
      margin-top: 0.8rem;
      background: #f8fafc;
      border-radius: 8px;
      padding: 1.1em 1.1em 0.2em 1.1em;
      box-shadow: 0 1px 6px #0001;
      font-size: 0.99em;
      max-height: 240px;
      overflow-y: auto;
    }
    .activity-item {
      border-left: 3px solid #22c55e;
      margin-bottom: 1.05em;
      padding-left: 0.7em;
      color: #444;
      font-size: 0.98em;
    }
    .activity-date {
      color: #888;
      font-size: 0.89em;
      margin-left: 0.4em;
    }
    .profile-success {
      color: #22c55e;
      margin-top: 0.6em;
      font-size: 1em;
      min-height: 1.4em;
    }
    .exit-profile-btn {
      background: #f97316;
      color: #fff;
      border: none;
      border-radius: 999px;
      font-size: 1.1rem;
      font-weight: 700;
      padding: 0.52em 2em;
      margin: 2em auto 0 auto;
      cursor: pointer;
      transition: background 0.18s;
      display: block;
      box-shadow: 0 2px 9px rgba(249,115,22,.09);
    }
    .exit-profile-btn:hover {
      background: #ea580c;
    }
    @media (max-width: 600px) {
      .profile-container {
        padding: 0.6rem 0.3rem 1.5rem 0.3rem;
      }
      .profile-header { flex-direction: column; align-items: flex-start; gap: 0.7rem; }
      .profile-info h2 { font-size: 1.18rem;}
      .profile-section-title { font-size: 1.07rem;}
      .role-switcher { flex-direction: column; gap: 0.4rem;}
      .exit-profile-btn { font-size: 1rem; padding: 0.54em 1.2em; margin-top: 1.2em;}
    }
    nav.navbar {
      background-color: navy !important;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem 1.2rem;
      flex-wrap: wrap;
    }
    nav.navbar .navbar-logo {
      color: #fff;
      font-size: 1.4rem;
      font-weight: bold;
      text-decoration: none;
      letter-spacing: 1px;
    }
    nav.navbar .navbar-logo span {
      font-size: 0.97em;
      color: #f5f5f5 !important;
    }
    nav.navbar .navbar-menu {
      display: flex;
      gap: 1.1rem;
      flex: 1 1 auto;
      justify-content: flex-start;
      margin-left: 2.2rem;
    }
    nav.navbar .nav-horizontal ul {
      display: flex;
      gap: 1.2em;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    nav.navbar .nav-link, nav.navbar .navbar-menu a {
      color: #e1e0da;
      text-decoration: none;
      font-size: 1rem;
      font-weight: 500;
      padding: 0.3em 0.6em;
      border-radius: 4px;
      transition: background 0.18s, color 0.18s;
      display: inline-block;
    }
    nav.navbar .nav-link:hover,
    nav.navbar .nav-link:focus,
    nav.navbar .navbar-menu a:hover,
    nav.navbar .navbar-menu a:focus {
      background: #546f81;
      color: #fff;
    }
    nav.navbar .navbar-actions {
      display: flex;
      gap: 0.7rem;
      align-items: center;
      margin-left: 1.2em;
    }
    nav.navbar .nav-auth-btn {
      background: #f97316;
      color: #fff;
      border: none;
      border-radius: 999px;
      padding: 0.52em 1.5em;
      font-size: 1rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.6em;
      cursor: pointer;
      box-shadow: 0 2px 9px rgba(249,115,22,.09);
      outline: none;
      transition: background 0.18s, box-shadow 0.18s, transform 0.15s;
      margin-left: 0.4em;
      letter-spacing: 0.03em;
    }
    nav.navbar .nav-auth-btn:hover, nav.navbar .nav-auth-btn:focus {
      background: #ea580c;
      box-shadow: 0 3px 16px rgba(249,115,22,.19);
      color: #fff;
      transform: translateY(-2px) scale(1.04);
    }
    nav.navbar .nav-auth-btn i {
      font-size: 1.1em;
      margin-right: 0.2em;
    }
    .navbar-profile {
      display: flex;
      align-items: center;
      margin-left: 1.2em;
      margin-right: 1.2em;
    }
    .navbar-profile a {
      padding: 0;
      background: none;
      border: none;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 48px;
    }
    .navbar-profile .profile-avatar {
      width: 40px;
      height: 40px;
      font-size: 1.1rem;
    }
    @media (max-width: 900px) {
      nav.navbar {
        flex-wrap: wrap;
        gap: 0.6em;
      }
      nav.navbar > * {
        flex: unset;
      }
      .navbar-profile {
        margin-left: 0.8em;
        margin-right: 0.8em;
      }
    }
    @media (max-width: 600px) {
      nav.navbar {
        flex-direction: column;
        align-items: stretch;
        gap: 0.6rem;
        padding: 0.5rem 0.5rem;
      }
      nav.navbar .navbar-menu {
        margin-left: 0;
        gap: 0.6rem;
        flex-wrap: wrap;
      }
      nav.navbar .nav-horizontal ul {
        gap: 0.5em;
      }
      .navbar-actions {
        display: flex;
        align-items: center;
        margin-left: 0.4em;
      }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <a href="/" class="navbar-logo">
      OASIS <b><span>Student Portal</span></b>
    </a>
    <div class="navbar-menu">
      <nav class="nav-horizontal">
        <ul>
          <li><a href="dashboard.html" class="nav-link">Dashboard</a></li>
          <li><a href="documents.html" class="nav-link">Documents</a></li>
          <li><a href="medical.html" class="nav-link">Medical</a></li>
          <li><a href="timetable.html" class="nav-link">Timetable</a></li>
          <li><a href="adminTools.html" class="nav-link">Admin Tools</a></li>
          <li><a href="help.html" class="nav-link">Help Desk</a></li>
        </ul>
      </nav>
    </div>
    <div class="navbar-profile">
      <a href="index.html" title="My Profile">
        <div class="profile-avatar" id="navProfileAvatar">A</div>
      </a>
    </div>
    <div class="navbar-actions">
      <button id="loginLogoutBtn" class="nav-auth-btn" type="button">
        <i class="fas fa-sign-in-alt"></i> Login
      </button>
    </div>
  </nav>

  <div class="profile-container">
    <div class="profile-header">
      <div class="profile-avatar" id="profileAvatar">A</div>
      <div class="profile-info">
        <h2 id="profileName">Student Name</h2>
        <p id="profileEmail">student@email.com</p>
      </div>
    </div>

    <div class="role-switcher">
      <label for="role-select">Switch Role:</label>
      <select id="role-select" class="role-select">
        <option value="student">Student</option>
        <option value="admin">Admin</option>
        <option value="guest">Guest</option>
      </select>
      <span id="role-switch-success" style="color:#22c55e;font-size:0.95em;"></span>
    </div>

    <div class="profile-section">
      <div class="profile-section-title">Contact & Home Address</div>
      <form id="profileForm" class="profile-form" autocomplete="off">
        <label for="contact">Contact Number</label>
        <input type="tel" id="contact" name="contact" required maxlength="20" />
        <label for="address">Home Address</label>
        <textarea id="address" name="address" required maxlength="200"></textarea>
        <button type="submit" class="profile-save-btn">Save Changes</button>
        <div class="profile-success" id="profileSuccessMsg"></div>
      </form>
    </div>

    <div class="profile-section">
      <div class="profile-section-title">Recent Activities</div>
      <div class="profile-activities" id="profileActivities">
        <!-- Activity items will be loaded here -->
      </div>
    </div>
    <!-- Exit Profile Button -->
    <button class="exit-profile-btn" id="exitProfileBtn">
      <i class="fas fa-sign-out-alt"></i> Exit Profile Page
    </button>
  </div>
  <script>
    // Dummy user data for demonstration
    let user = {
      name: "Amina Yusuf",
      email: "240072225@mubs.ac.ug",
      contact: "+256781492126",
      address: "123, Mugabe Avenue, Kampala",
      role: "student",
      roles: ["student", "admin", "guest"],
      activities: [
        { action: "Submitted assignment: Mathematics", date: "2025-07-26 09:33" },
        { action: "Updated home address", date: "2025-07-19 16:54" },
        { action: "Changed role to Prefect", date: "2025-07-10 08:27" },
        { action: "Logged in", date: "2025-07-01 10:14" }
      ]
    };

    // ========== LOGIN/LOGOUT LOGIC ==========
    function isLoggedIn() {
      return localStorage.getItem('isLoggedIn') === 'true';
    }

    function setLoggedIn(status) {
      localStorage.setItem('isLoggedIn', status ? 'true' : 'false');
    }

    function updateLoginLogoutButton() {
      const btn = document.getElementById('loginLogoutBtn');
      if (!btn) return;
      if (isLoggedIn()) {
        btn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
        btn.onclick = function() {
          setLoggedIn(false);
          updateLoginLogoutButton();
          window.location.href = "Login.html";
        };
        btn.setAttribute("aria-label", "Logout");
      } else {
        btn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
        btn.onclick = function() {
          setLoggedIn(true);
          updateLoginLogoutButton();
          window.location.href = "dashboard.html";
        };
        btn.setAttribute("aria-label", "Login");
      }
    }

    // On page load, set login/logout button state
    if (localStorage.getItem('isLoggedIn') === null) {
      setLoggedIn(true); // Assume logged in by default for demo
    }
    updateLoginLogoutButton();

    // Set navbar avatar
    document.getElementById('navProfileAvatar').textContent = user.name[0].toUpperCase();

    // Populate profile
    document.getElementById('profileName').textContent = user.name;
    document.getElementById('profileEmail').textContent = user.email;
    document.getElementById('contact').value = user.contact;
    document.getElementById('address').value = user.address;
    document.getElementById('role-select').value = user.role;
    document.getElementById('profileAvatar').textContent = user.name[0].toUpperCase();

    // Populate activities
    function renderActivities() {
      const actDiv = document.getElementById('profileActivities');
      actDiv.innerHTML = '';
      if (user.activities.length === 0) {
        actDiv.innerHTML = '<div style="color:#888;">No activities yet.</div>';
        return;
      }
      user.activities.forEach(act => {
        const el = document.createElement('div');
        el.className = 'activity-item';
        el.innerHTML = `${act.action} <span class="activity-date">${act.date}</span>`;
        actDiv.appendChild(el);
      });
    }
    renderActivities();

    // Role switching
    document.getElementById('role-select').addEventListener('change', function() {
      const newRole = this.value;
      user.role = newRole;
      user.activities.unshift({
        action: "Changed role to " + newRole.charAt(0).toUpperCase() + newRole.slice(1),
        date: new Date().toISOString().slice(0,16).replace('T', ' ')
      });
      document.getElementById('role-switch-success').textContent = "Role switched!";
      setTimeout(() => { document.getElementById('role-switch-success').textContent = ""; }, 1500);
      renderActivities();
      // TODO: Save role change to backend if needed
    });

    // Profile form submission
    document.getElementById('profileForm').addEventListener('submit', function(e) {
      e.preventDefault();
      user.contact = document.getElementById('contact').value;
      user.address = document.getElementById('address').value;
      user.activities.unshift({
        action: "Updated contact/home address",
        date: new Date().toISOString().slice(0,16).replace('T', ' ')
      });
      document.getElementById('profileSuccessMsg').textContent = "Profile updated!";
      renderActivities();
      setTimeout(() => { document.getElementById('profileSuccessMsg').textContent = ""; }, 1500);
      // TODO: Save contact & address to backend if needed
    });

    // Exit profile page button
    document.getElementById('exitProfileBtn').addEventListener('click', function(){
      window.location.href = "dashboard.html";
    });
  </script>
<script src="script.js"></script>
</body>
</html>